# 高中家校生活模拟器 - UI设计需求文档

## ⚠️ 重要说明：UI与功能逻辑整合

**本UI设计完全基于"仿微信聊天窗口"的单一界面**。

* **所有功能都通过聊天窗口触发**：家长操作、孩子回复、系统反馈都在同一个对话界面中完成
* **不存在独立的操作面板**：充值、寄送、建议等功能都通过聊天窗口的按钮和弹窗实现
* **消息类型明确对应**：家长气泡、孩子气泡、系统灰条、群聊消息都有明确的视觉区分

### 功能触发流程
1. **家长操作** → 点击聊天窗口按钮 → 弹出操作面板 → 确认操作 → 系统灰条反馈 → 孩子气泡回复
2. **孩子主动** → 系统生成孩子气泡/来电弹窗 → 家长选择回复 → 继续对话
3. **群聊互动** → 群聊界面 → 家长发言 → 群聊气泡显示 → 群氛围影响

### UI组件与功能规则对应

| UI组件 | 功能规则 | 视觉反馈 | 后续动作 |
|--------|----------|----------|----------|
| 伪输入框 | `parent_msg` 候选选择 | 弹出3个候选消息 | 家长绿色气泡发送 |
| 建议按钮 | `ACT.SUGGESTION.<TOPIC>` | 弹出3个建议选项 | 家长绿色气泡建议 → 孩子白色气泡回复 |
| 寄送物品按钮 | `ACT.SEND_PARCEL.<ITEM>` | 弹出物品选择面板 | 系统灰条「已寄送」→ 延迟孩子气泡感谢 |
| 充值校园卡按钮 | `ACT.RECHARGE.CAMPUS` | 弹出金额选择面板 | 系统灰条「充值成功」→ 下个时段孩子气泡感谢 |
| 充值电话卡按钮 | `ACT.RECHARGE.PHONE` | 弹出金额选择面板 | 系统灰条「充值成功」→ 下个时段孩子气泡感谢 |
| 来电弹窗 | `child_call` 事件 | 接听/忽略/稍后选项 | 接听→孩子需求说明→3个应答选项 |
| 群聊发言 | `ACT.GROUP_POST.*` | 群聊灰色气泡 | 群氛围数值变化 |
| 状态查看按钮 | 状态面板显示 | 弹出状态详情面板 | 显示所有数值和日志 |

---

## 1. 聊天窗口布局

### 1.1 整体样式
* 仿微信聊天窗口设计
* 消息气泡：
  * 家长消息 → 绿色气泡，右对齐
  * 孩子消息 → 白色气泡，左对齐
* 头像显示：每条消息左侧/右侧显示对应头像（孩子/家长）
* 时间戳：相邻两条消息间隔 >5 分钟时，在中间插入灰色时间提示

### 1.2 引用样式
* 引用消息 → 新气泡显示灰底引用条
* 引用内容：显示被引用消息的前50个字符
* 点击引用条可跳转到原消息

---

## 2. 消息类型

### 2.1 文本消息
* 基础聊天内容，气泡内显示
* 支持表情符号和简单格式化

### 2.2 系统消息（灰色条居中）
* 提示「无人接听，孩子在安静时段」
* 提示「校园卡余额不足」
* 提示「电话卡欠费，暂无法回复」
* 系统消息样式：灰色背景，居中显示，字体较小

### 2.3 按钮型消息
* 气泡内嵌按钮，点击后触发逻辑：
  * "回拨 / 忽略"
  * "留言 / 取消"
  * "确认充值 / 取消"
* 按钮样式：圆角矩形，主色调，悬停效果

---

## 3. 输入框区

### 3.1 输入框设计
* 装饰性UI位于底部，不支持文字输入
* 显示"点击下方按钮进行操作"提示
* 样式：灰色背景，圆角边框

### 3.2 附加按钮
* "发送" → 发送文字（暂未实现）
* "建议" → 打开候选面板（生成 1/2/3 条建议）
* "功能" → 打开操作面板（寄送物品/校园卡充值/电话卡充值）
* 按钮布局：水平排列，等宽分布

---

## 4. 功能面板

### 4.1 寄送物品面板
* 弹出物品库选择框（分类 + 搜索）
* 分类标签：食品、学习、衣物、卫生、运动
* 物品卡片：显示物品名称、描述、效果
* 确认按钮：选择物品后确认寄送

### 4.2 校园卡充值面板
* 弹出充值金额输入框 + 确认按钮
* 预设金额：20元、50元、100元
* 自定义金额：手动输入
* 余额显示：当前校园卡余额

### 4.3 电话卡充值面板
* 同上校园卡充值面板设计
* 显示当前电话卡余额

---

## 5. 状态反馈

### 5.1 Toast 提示
* 屏幕底部，2 秒后消失
* 成功提示：「充值成功」「物品已寄送」
* 错误提示：「余额不足」「操作失败」
* 样式：半透明黑色背景，白色文字

### 5.2 对话反馈
* 操作完成后在聊天窗口生成一条系统反馈消息
* 例如：「你已成功为孩子充值 50 元校园卡」
* 例如：「你已为孩子寄送方便面，预计2天后到达」

---

## 6. 建议系统UI

### 6.1 建议候选面板
* 弹出式面板，显示1-3条建议选项
* 建议内容：基于当前聊天上下文生成
* 建议类型：学业、作息、饮食、社交、自理、节制消费
* 选择建议：点击后发送给系统处理

### 6.2 建议反馈显示
* 孩子接受建议：绿色系统提示
* 孩子拒绝建议：黄色系统提示
* 建议冷却：显示剩余冷却时间

---

## 7. 群聊功能UI

### 7.1 群聊消息显示
* 群聊消息：灰色气泡，居中显示
* 显示发送者：老师/家长姓名
* 时间戳：群聊消息的时间标记

### 7.2 群聊发言选项
* 在群聊消息下方显示发言选项
* 发言类型：安抚、对比/晒、提问
* 冷却提示：显示发言冷却时间

---

## 8. 状态指示器

### 8.1 孩子状态显示
* 当前状态：上课/午休/晚自习/放学/就寝
* 状态图标：不同状态对应不同图标
* 状态颜色：不同状态对应不同颜色

### 8.2 余额显示
* 校园卡余额：实时显示
* 电话卡余额：实时显示
* 低额预警：余额不足时红色显示

---

## 9. 响应式设计

### 9.1 移动端适配
* 支持手机屏幕尺寸
* 触摸友好的按钮大小
* 滑动操作支持

### 9.2 桌面端适配
* 支持鼠标悬停效果
* 键盘快捷键支持
* 窗口大小调整

---

## 10. 交互细节

### 10.1 加载状态
* 操作进行中显示加载动画
* 网络请求失败显示重试按钮
* 长时间无响应显示超时提示

### 10.2 错误处理
* 友好的错误提示信息
* 操作失败后的恢复建议
* 网络异常时的离线提示

---

## 11. 配置引用说明

本UI设计文档中的样式参数和交互规则均引用 `/config` 目录下的配置文件：

### 11.1 全局参数引用
* 冷却时间：引用 `config/global_params.csv` 中的相关参数
* 余额阈值：引用 `config/global_params.csv` 中的 `campus_warn`、`tel_warn` 等

### 11.2 规则配置引用
* 按钮状态控制：引用 `config/rules_config.csv` 中的规则定义
* 功能可用性：根据规则配置控制按钮的启用/禁用状态

### 11.3 反馈模板引用
* 系统提示文案：引用 `config/feedback_seed.csv` 中的模板
* 孩子回复样式：根据模板生成相应的UI显示效果

---

## 12. 设计规范

### 12.1 颜色规范
* 主色调：#07C160（微信绿）
* 辅助色：#FF6B6B（错误红）、#4ECDC4（成功绿）
* 文字色：#333333（主要文字）、#999999（次要文字）

### 12.2 字体规范
* 主要文字：14px，系统默认字体
* 次要文字：12px，系统默认字体
* 标题文字：16px，加粗

### 12.3 间距规范
* 消息间距：8px
* 按钮间距：12px
* 面板内边距：16px
